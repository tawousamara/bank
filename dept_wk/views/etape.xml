<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="wk_etape_action" model="ir.actions.act_window">
        <field name="name">المديرية</field>
        <field name="res_model">wk.etape</field>
        <field name="view_mode">tree,form</field>
    </record>
    <record id="view_wk_etape_form" model="ir.ui.view">
        <field name="name">wk.etape.form</field>
        <field name="model">wk.etape</field>
        <field name="arch" type="xml">
            <form create="0" duplicate="false" delete="0">
                <header>
                    <field name="state_branch" widget="statusbar"
                           statusbar_visible="branch_1,branch_2,branch_3,branch_4,branch_5" invisible="sequence != 1"/>
                    <field name="state_finance" widget="statusbar"
                           statusbar_visible="finance_1,finance_2,finance_3,finance_4" invisible="sequence != 2"/>
                    <field name="state_commercial" widget="statusbar"
                           statusbar_visible="commercial_1,commercial_2,commercial_3,commercial_4"
                           invisible="sequence != 3"/>
                    <field name="state_risque" widget="statusbar"
                           statusbar_visible="risque_1,risque_3,risque_4,risque_2" invisible="sequence != 4"/>
                    <field name="state_vice" widget="statusbar"
                           statusbar_visible="vice_1,vice_2" invisible="sequence != 5"/>
                    <field name="state_dg" widget="statusbar"
                           statusbar_visible="dg_1,dg_2" invisible="sequence != 9"/>
                    <field name="state_comite" widget="statusbar"
                           statusbar_visible="comite_1,comite_2" invisible="sequence != 6"/>
                    <button name="revoir_action" type="object" string="للمراجعة"
                            invisible="state_branch in ['branch_1','branch_rejected'] or (dossier_verouiller and state_commercial == 'commercial_1')"
                            class="btn-secondary"/>
                    <button name="reject_request" type="object" string="رفض الطلب"
                            class="btn-secondary"/>
                    <button name="create_pouvoir" invisible="1" type="object" string="معلومات"
                            class="btn-secondary"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="open_tracking"
                                type="object"
                                icon="fa-history"/>
                        <button name="open_messages"
                                type="object"
                                icon="fa-regular fa-envelope"/>
                        <button name="open_revision_branch"
                                type="object"
                                class="oe_stat_button" invisible="sequence != 2"
                        >مراجعة بيانات الفرع
                        </button>
                    </div>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <div>
                        <field name="sequence" invisible="1"/>
                        <field name="dossier_verouiller" invisible="1"/>
                        <field name="active" invisible="1"/>
                        <field name="can_edit" invisible="1"/>
                        <field name="company_ids" invisible="1"/>
                        <field name="can_edit_finance" invisible="1"/>
                    </div>
                    <div invisible="raison_a_revoir == False" style="border: 2px solid;
                                border-radius: 12px;
                                border-style: dashed;
                                border-color: #ff2345;
                                margin-bottom: 2px;
                                padding: 5px;">
                        <group>
                            <field name="raison_a_revoir" readonly="1"/>
                        </group>
                    </div>
                    <div invisible="sequence not in [1,3,5,6,8]">
                        <group invisible="sequence != 1">
                            <field name="assigned_to_agence" options="{'no_create': True, 'no_open': True}"/>
                        </group>
                        <group col="1">
                            <group>
                                <field name="nom_client" readonly="not can_edit"
                                       context="{'default_is_client':True}"
                                       options="{'no_create': True, 'no_open': True}"
                                       domain="[('is_client', '=', True)]"/>
                                <field name="num_compte" readonly="1"/>
                                <field name="date_ouverture_compte" readonly="1"/>
                                <field name="branche" readonly="1" options="{'no_create': True, 'no_open': True}"/>
                                <field name="demande" readonly="not can_edit"
                                       options="{'no_create': True, 'no_open': True}"/>
                                <field name="doc_checked_vis" invisible="1"/>
                                <field name="state_compute" invisible="1"/>
                            </group>
                        </group>
                        <div invisible="sequence not in [1,8]">
                            <div class="oe_title">
                                <h1>
                                    الوثائق المرفقة مع الطلب الحالي
                                </h1>
                            </div>
                            <field name="documents" nolabel="1"
                                   readonly="not can_edit">
                                <tree editable="bottom" delete="0">
                                    <field name="list_doc"
                                           decoration-info="list_document in ['1', '2', '7', '8', '12', '13', '15', '16']"/>
                                    <field name="document" widget="binary" filename="filename"
                                           readonly="checked == True"/>
                                    <field name="answer" readonly="checked != True"/>
                                    <field name="note" readonly="checked != True"/>
                                    <field name="checked" column_invisible="True"/>
                                    <field name="list_document" column_invisible="True"/>
                                    <button name="open_document" string="" icon="fa-eye" type="object"
                                            style="display: inline-block;color: #808080; background-color: white"/>

                                </tree>
                            </field>
                        </div>
                        <group string="تقرير الزيارة" col="2" invisible="sequence not in [1,8]">
                            <group>
                                <field name="classification" readonly="1"
                                       options="{'no_create': True, 'no_open': True}"/>
                                <field name="adress_siege" readonly="1"/>
                                <field name="wilaya" readonly="1" options="{'no_create': True, 'no_open': True}"/>
                                <field name="nif" readonly="1"/>
                                <field name="num_registre_commerce" readonly="1"/>
                                <field name="date_inscription" readonly="1"/>
                                <field name="date_debut_activite" readonly="1"/>
                                <field name="activite" readonly="1" options="{'no_create': True, 'no_open': True}"/>
                                <field name="activite_sec" readonly="1"/>
                            </group>
                            <group>
                                <field name="activity_code" readonly="1"/>
                                <field name="activity_description" readonly="1"/>
                                <field name="phone" readonly="1" style="direction: ltr;text-align: right;"/>
                                <field name="email" readonly="1" widget="email"/>
                                <field name="siteweb" readonly="1"/>
                                <field name="gerant" readonly="not can_edit or state_branch != 'branch_1'"
                                       options="{'no_create': True, 'no_open': True}"
                                       context="{'default_parent_id': nom_client, 'default_is_client':True}"/>
                                <field name="partner_id" readonly="1" invisible="1"/>
                                <field name="phone_gerant" readonly="1" style="direction: ltr;text-align: right;"/>
                                <field name="email_gerant" readonly="1"/>
                                <field name="email_to" invisible="1"/>
                                <field name="forme_jur" readonly="1" options="{'no_create': True, 'no_open': True}"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="chiffre_affaire"
                                       readonly="1"
                                       widget="monetary"
                                       options="{'currency_field': 'currency_id'}"/>
                            </group>
                        </group>
                        <notebook string="معرفة عميلك"
                                  invisible="state_branch not in ['branch_3', 'branch_4','branch_rejected','branch_5'] and sequence not in [3,5,8]">
                            <page string="توزيع راس مال الشركة">
                                <field name="apropos" width="100%"
                                       readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                    <tree editable="bottom">
                                        <field name="nom_partenaire" width="20%"/>
                                        <field name="age" width="20%"/>
                                        <field name="statut_partenaire" width="20%"/>
                                        <field name="nationalite" width="20%"/>
                                        <field name="pourcentage" sum="Total" widget="percentage" width="20%"/>
                                    </tree>
                                </field>
                            </page>
                            <page name="اعرف عميلك KYC">
                                <field name="kyc"
                                       readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                    <tree create="0" delete="0" editable="bottom">
                                        <field name="info" style="text-align: center" readonly="1"/>
                                        <field name="answer"/>
                                        <field name="detail"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="فريق التسيير">
                                <group>
                                    <field name="gestion" width="100%"
                                           readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                        <tree editable="bottom">
                                            <field name="name" width="20%"/>
                                            <field name="job" width="20%"/>
                                            <field name="niveau_etude" width="20%"/>
                                            <field name="age" width="20%"/>
                                            <field name="experience" width="20%"/>
                                        </tree>
                                    </field>
                                    <field name="employees"
                                           readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                        <tree create="0" delete="0" editable="bottom">
                                            <field name="name" readonly="1"/>
                                            <field name="poste_permanent"/>
                                            <field name="poste_non_permanent"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            <page string="مقرات تابعة للشركة">
                                <field name="sieges"
                                       readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                    <tree create="0" delete="0" editable="bottom">
                                        <field name="name" readonly="1"/>
                                        <field name="adresse"/>
                                        <field name="nature" options="{'no_create': True, 'no_open': True}"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="حجم و هيكل التمويلات المطلوبة">
                                <field name="tailles"
                                       readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                    <tree editable="bottom">
                                        <field name="type_demande" options="{'no_create': True, 'no_open': True}"
                                               domain="[('for_branch', '=', True)]"
                                               width="20%"/>
                                        <field name="montant" sum="Total" width="20%"/>
                                        <field name="raison" width="20%"/>
                                        <field name="preg" widget="percentage" width="20%"/>
                                        <field name="duree" width="20%"/>
                                        <field name="garanties" column_invisible="1"/>
                                        <field name="compute_exist" column_invisible="1"/>
                                    </tree>
                                </field>
                                <group>
                                    <field name="garanties" type="html"/>
                                </group>
                            </page>
                            <page string="الوضعية المالية">
                                <group>
                                    <field name="situations" width="100%"
                                           readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                        <tree editable="bottom">
                                            <field name="banque" width="20%"/>
                                            <field name="type_fin" width="20%"/>
                                            <field name="montant" width="20%"/>
                                            <field name="encours" width="20%"/>
                                            <field name="garanties" width="20%"/>
                                        </tree>
                                    </field>
                                    <group>
                                        <field name="annee_fiscal_list" options="{'no_create': True,'no_open': True}"/>
                                    </group>
                                    <field name="situations_fin"
                                           readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                        <tree editable="bottom" delete="0" create="0">
                                            <field name="type" readonly="1"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year1" readonly="sequence == 0"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year2" readonly="sequence == 0"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year3" readonly="sequence == 0"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="sequence" column_invisible="True"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            <page string="الموردون و الزبائن">
                                <group>
                                    <field name="fournisseur"
                                           readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                        <tree editable="bottom">
                                            <field name="name"/>
                                            <field name="country" domain="[('to_show', '=', False)]"/>
                                            <field name="type_payment" widget="many2many_tags"/>
                                        </tree>
                                    </field>
                                    <field name="client"
                                           readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                        <tree editable="bottom">
                                            <field name="name"/>
                                            <field name="country" domain="[('to_show', '=', False)]"/>
                                            <field name="type_payment" widget="many2many_tags"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            <page string="معلومات حول الشركات ذات الصلة (KDA)">
                                <field name="companies"
                                       readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                    <tree editable="bottom">
                                        <field name="name" width="10%"/>
                                        <field name="date_creation" width="10%"/>
                                        <field name="activite" options="{'no_create': True}" width="20%"/>
                                        <field name="chiffre_affaire" width="20%"/>
                                        <field name="n1_num_affaire" width="20%"/>
                                        <field name="n_num_affaire" width="20%"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        <group col="2" string="نبذة عن نشاط الشركة"
                               invisible="state_branch not in ['branch_3', 'branch_4','branch_rejected','branch_5'] and sequence not in [3,5,8]">
                            <field name="description_company"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="history_relation"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="unit_prod"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="stock"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="prod_company"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="politique_comm"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="cycle_exploit"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="concurrence"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                        </group>
                        <group invisible="state_branch not in ['branch_3', 'branch_4','branch_rejected','branch_5'] and sequence not in [3,5,8]">
                            <field name="program_invest"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="result_visit"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="images"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]">
                                <tree editable="bottom">
                                    <field name="picture" widget="binary" filename="name"/>
                                    <field name="to_show"/>
                                    <field name="name" column_invisible="1"/>
                                </tree>
                            </field>
                        </group>
                        <button name="action_create_risk" type="object" string="ملأ بطاقة المعايير النوعية"
                                class="button_secondary"
                                invisible="risk_scoring != False or state_branch not in ['branch_3', 'branch_4','branch_rejected','branch_5']"/>
                        <group>
                            <field name="risk_scoring"
                                   invisible="risk_scoring == False or state_branch not in ['branch_3', 'branch_4','branch_rejected','branch_5']"
                                   readonly="1"/>
                        </group>
                        <group invisible="state_branch not in ['branch_3', 'branch_4','branch_rejected','branch_5'] and sequence not in [5,6,8,9]">
                            <field name="recommendation_visit"
                                   readonly="not can_edit or state_branch != 'branch_3' and sequence not in [1, 8]"/>
                            <field name="recommendation_responsable_agence"
                                   readonly="not can_edit or state_branch != 'branch_4' and sequence not in [1, 8]"/>
                        </group>
                    </div>
                    <div invisible="sequence not in [2,5,6,9]">
                        <field name="documents" nolabel="1" readonly="1" invisible="sequence != 2">
                            <tree>
                                <field name="document" widget="binary" filename="filename"/>
                                <field name="answer"/>
                                <field name="note"/>
                                <field name="filename" column_invisible="True"/>

                                <button name="open_document" string="" icon="fa-eye" type="object"
                                        style="display: inline-block;color: #808080; background-color: white"/>

                            </tree>
                        </field>
                        <group>
                            <field name="assigned_to_finance" options="{'no_create': True, 'no_open': True}"
                                   invisible="sequence != 2"
                                   readonly="not can_edit_finance or state_finance not in ['finance_1', 'finance_2']"/>
                        </group>
                        <group invisible="state_finance == 'finance_1' or sequence != 2" class="col-4">
                            <field name="taux_change" readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="annee_fiscal" invisible="1"/>
                            <field name="annee_fiscal_list" options="{'no_create': True,'no_open': True}"
                                   readonly="not can_edit or state_finance != 'finance_2'"/>
                        </group>
                        <notebook invisible="state_finance == 'finance_1' or sequence != 2">
                            <page string="تفاصيل التسهيلات الممنوحة (KDA)">
                                <field name="facilite_accorde" width="100%"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="type_demande_ids" options="{'no_create': True}"
                                               domain="[('for_branch', '=', False)]"
                                               width="15%" widget="many2many_tags"/>
                                        <field name="date" width="10%"/>
                                        <field name="credit" width="10%"/>
                                        <field name="montant_da_actuel" width="15%"/>
                                        <field name="montant_dollar_actuel" optional="hide"/>
                                        <field name="montant_da_demande" width="15%"/>
                                        <field name="montant_dollar_demande" optional="hide"/>
                                        <field name="montant_da_total" width="15%"/>
                                        <field name="montant_dollar_total" optional="hide"/>
                                        <field name="garantie_montant" widget="percentage" width="15%"/>
                                        <field name="compute_exist" column_invisible="True"/>
                                        <field name="remarques" width="10%"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="تفاصيل الضمانات">
                                <h6>الضمانات العقارية الحالية</h6>
                                <field name="detail_garantie_actuel_ids"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="type_garantie" options="{'no_create': True}"/>
                                        <field name="type_contrat"/>
                                        <field name="montant"/>
                                        <field name="date"/>
                                        <field name="recouvrement" widget="percentage"/>
                                        <field name="niveau"/>
                                    </tree>
                                </field>
                                <group>
                                    <field name="garantie_actuel_comment"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                </group>
                                <h6>الضمانات العقارية المقترحة</h6>
                                <field name="detail_garantie_propose_ids"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="type_garant" options="{'no_create': True}"/>
                                        <field name="type_contrat" options="{'no_create': True}"/>
                                        <field name="montant"/>
                                        <field name="date"/>
                                        <field name="recouvrement" widget="percentage"/>
                                        <field name="niveau"/>
                                    </tree>
                                </field>
                                <group>
                                    <field name="garantie_propose_comment"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                </group>
                            </page>
                            <page string='الشروط السابقة/المقترحة و الموافق عليها من لجان التمويل'>
                                <field name="garantie_conf"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="info"/>
                                        <field name="answer"/>
                                        <field name="detail"/>
                                    </tree>
                                </field>
                            </page>
                            <page string='الشروط المالية'>
                                <field name="garantie_fin"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="info"/>
                                        <field name="answer"/>
                                        <field name="detail"/>
                                    </tree>
                                </field>
                            </page>
                            <page string='الشروط الاخرى'>
                                <field name="garantie_autres"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="info"/>
                                        <field name="answer"/>
                                        <field name="detail"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        <notebook invisible="state_finance == 'finance_1' or sequence != 2">
                            <page string="مركزية المخاطر (KDA)">
                                <group>
                                    <group>
                                        <field name="risque_date"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                    <group>
                                        <field name="nbr_banque"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                </group>
                                <field name="risque_central"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree create="0" editable="bottom"
                                          delete="0"> <!-- a ajouter la fonctionnalité de suppression pour bloque le total-->
                                        <field name="declaration" readonly="1"/>
                                        <field name="montant_esalam_dz_donne"/>
                                        <field name="montant_esalam_dollar_donne" optional="hide"/>
                                        <field name="montant_esalam_dz_used"/>
                                        <field name="montant_esalam_dollar_used" optional="hide"/>
                                        <field name="montant_other_dz_donne"/>
                                        <field name="montant_other_dollar_donne" optional="hide"/>
                                        <field name="montant_other_dz_used"/>
                                        <field name="montant_other_dollar_used" optional="hide"/>
                                        <field name="montant_total_dz_donne"/>
                                        <field name="montant_total_dollar_donne" optional="hide"/>
                                        <field name="montant_total_dz_used"/>
                                        <field name="montant_total_dollar_used" optional="hide"/>
                                    </tree>
                                </field>
                                <group>
                                    <field name="comment_risk_central"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                    <field name="capture_filename" invisible="1"/>
                                    <field name="risk_capture" filename="capture_filename" class="col-6"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                </group>
                            </page>
                            <page string="الوضعية الجبائية وشبه الجبائية">
                                <field name="position_tax" readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom" create="0" delete="0">
                                        <field name="name" readonly="1"/>
                                        <field name="adversite"/>
                                        <field name="non_adversite"/>
                                        <field name="notes"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="الحركة والأعمال الجانبية للحساب مع مصرف السلام الجزائر (KDA)">
                                <field name="mouvement" readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree create="0" editable="bottom">
                                        <field name="mouvement" decoration-bf="sequence == 0" readonly="1"/>
                                        <field name="n3_dz" decoration-bf="sequence == 0"
                                               readonly="sequence in [0, 3]"/>
                                        <field name="n3_dollar" optional="hide" readonly="sequence in [3]"/>
                                        <field name="n2_dz" decoration-bf="sequence == 0"
                                               readonly="sequence in [0, 3]"/>
                                        <field name="n2_dollar" optional="hide" readonly="sequence in [3]"/>
                                        <field name="n1_dz" decoration-bf="sequence == 0"
                                               readonly="sequence in [0, 3]"/>
                                        <field name="n1_dollar" optional="hide" readonly="sequence in [3]"/>
                                        <field name="n_dz" decoration-bf="sequence == 0" readonly="sequence in [0, 3]"/>
                                        <field name="n_dollar" optional="hide" readonly="sequence in [3]"/>
                                        <field name="remarques" readonly="sequence == 0"/>
                                        <field name="sequence" column_invisible="True"/>
                                    </tree>
                                </field>
                                <group>
                                    <field name="detail_mouvement"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                </group>
                            </page>
                        </notebook>
                        <notebook invisible="state_finance == 'finance_1' or sequence != 2">
                            <page string="البيانات المالية الموجزة للشركات ذات الصلة (KDA)">
                                <field name="workflow" invisible="1"/>
                                <field name="risque_ids" mode="kanban"
                                       context="{'default_etape_id': active_id, 'default_parent_id': workflow}">
                                    <kanban>
                                        <field name="name"/>
                                        <field name="partner_id"/>
                                        <field name="groupe"/>
                                        <field name="secteur"/>
                                        <templates>
                                            <t t-name="kanban-box">
                                                <div t-attf-class="oe_kanban_global_click">
                                                    <div class="oe_kanban_details">
                                                        <field name="name"/>
                                                        <div t-if="record.partner_id">Client:
                                                            <field name="partner_id"/>
                                                        </div>
                                                        <div t-if="record.groupe">Groupe:
                                                            <field name="groupe"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                    <form>
                                        <sheet>
                                            <group>
                                                <field name="name"/>
                                                <field name="date"/>
                                                <field name="groupe" invisible="1"/>
                                                <field name="is_branch" invisible="1"/>
                                                <field name="partner_id" domain="[('groupe','=', groupe)]"/>
                                                <field name="critere_qual"/>
                                                <field name="critere_quant"/>
                                            </group>
                                            <group class="col-3">
                                                <field name="tcr_id" invisible="1"/>
                                                <group invisible="not tcr_id">
                                                    <field name="tcr_id"
                                                           groups="dept_wk.dept_wk_group_responsable_credit"
                                                           style="display: inline-block;"/>
                                                </group>
                                                <group invisible="not tcr_id">
                                                    <button name="open_file" string="" icon="fa-eye" type="object"
                                                            style="display: inline-block;color: #808080; background-color: white"/>
                                                </group>
                                                <group invisible="tcr_id">
                                                    <button name="create_file_tcr" string="انشاء TCR"
                                                            type="object"
                                                            style="display: inline-block;color: #808080; background-color: white"/>
                                                </group>
                                            </group>
                                            <group class="col-3">
                                                <field name="passif_id" invisible="1"/>
                                                <group invisible="not passif_id">
                                                    <field name="passif_id"
                                                           groups="dept_wk.dept_wk_group_responsable_credit"
                                                           style="display: inline-block;"/>
                                                </group>
                                                <group invisible="not passif_id">
                                                    <button name="open_file_passif" string="" icon="fa-eye"
                                                            type="object"
                                                            style="display: inline-block;color: #808080; background-color: white"/>
                                                </group>
                                                <group invisible="passif_id">
                                                    <button name="create_file_passif" string="انشاء Passif"
                                                            type="object"
                                                            style="display: inline-block;color: #808080; background-color: white"/>
                                                </group>
                                            </group>
                                            <group class="col-3">
                                                <field name="actif_id" invisible="1"/>
                                                <group invisible="not actif_id">
                                                    <field name="actif_id"
                                                           groups="dept_wk.dept_wk_group_responsable_credit"/>
                                                </group>
                                                <group invisible="not actif_id">
                                                    <button name="open_file_actif" string="" icon="fa-eye"
                                                            type="object"
                                                            style="display: inline-block;color: #808080; background-color: white"/>
                                                </group>
                                                <group invisible="actif_id">
                                                    <button name="create_file_actif" string="انشاء Actif"
                                                            type="object"
                                                            style="display: inline-block;color: #808080; background-color: white"/>
                                                </group>
                                            </group>
                                            <notebook>
                                                <page string="البيانات المالية الموجزة (KDA)">
                                                    <button name="import_data_group" type="object"
                                                            string="حمل البيانات"
                                                            class="button_secondary"/>
                                                    <field name="companies_fisc">
                                                        <tree editable="bottom" create="0" delete="0">
                                                            <field name="declaration" readonly="1"
                                                                   decoration-bf="sequence == 0"/>
                                                            <field name="year_3" readonly="sequence == 0"
                                                                   decoration-bf="sequence == 0"/>
                                                            <field name="year_4" readonly="sequence == 0"
                                                                   decoration-bf="sequence == 0"/>
                                                            <field name="sequence" column_invisible="True"/>
                                                        </tree>
                                                    </field>
                                                </page>
                                                <page string="المعايير النوعية">
                                                    <group>
                                                        <field name="scoring_qualitatif" invisible="is_branch"
                                                               readonly="1"/>
                                                    </group>
                                                    <group col="2" string="الإدارة، التسيير و الخبرة">
                                                        <field name="original_capital"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_origin"/>
                                                        <field name="actionnariat"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_actionnariat"/>
                                                        <field name="forme_jur"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_forme_jur"/>
                                                        <field name="remp_succession"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_remp_succession"/>
                                                        <field name="competence"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_competence"/>
                                                        <field name="experience"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_experience"/>
                                                    </group>
                                                    <group string="إستقرار قطاع النشاط">
                                                        <field name="soutien_etatic"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_soutien_etatic"/>
                                                        <field name="activite"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_activite"/>
                                                        <field name="influence_tech"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_influence_tech"/>
                                                    </group>
                                                    <group string="مكانة الشركة في القطاع">
                                                        <field name="anciennete"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_anciennete"/>
                                                        <field name="concurrence"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_concurrence"/>
                                                        <field name="source_appro"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_source_appro"/>
                                                        <field name="produit"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_produit"/>
                                                        <field name="flexibilite"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_flexibilite"/>
                                                    </group>
                                                    <group string="القروض و الأملاك">
                                                        <field name="sollicitude"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_sollicitude"/>
                                                        <field name="situation"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_situation"/>
                                                    </group>
                                                    <group string="علاقة الشركة مع المصرف">
                                                        <field name="mouvement"
                                                               options="{'no_create': True, 'no_open': True}"
                                                               groups="dept_wk.dept_wk_group_responsable_credit"/>
                                                        <field name="comment_mouvement"
                                                               groups="dept_wk.dept_wk_group_responsable_credit"/>
                                                        <field name="garanties"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_garantie"/>
                                                        <field name="incident"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_incident"/>
                                                        <field name="conduite"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_conduite"/>
                                                    </group>
                                                    <group string="علاقة الشركة مع الإدارات المميزة">
                                                        <field name="dette_fisc"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_dette_fisc"/>
                                                        <field name="dette_parafisc"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_dette_parafisc"/>
                                                        <field name="position_admin"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_position_admin"/>
                                                    </group>
                                                    <group string="مصادر التسديد">
                                                        <field name="source_remb"
                                                               options="{'no_create': True, 'no_open': True}"/>
                                                        <field name="comment_source_remb"/>
                                                    </group>
                                                    <group string="مركزية محفظة المصرف">
                                                        <field name="part_profil"
                                                               options="{'no_create': True, 'no_open': True}"
                                                               groups="dept_wk.dept_wk_group_responsable_credit"/>
                                                        <field name="comment_part_profil"
                                                               groups="dept_wk.dept_wk_group_responsable_credit"/>
                                                    </group>
                                                </page>
                                                <page string="المعايير الكمية"
                                                      groups="dept_wk.dept_wk_group_responsable_credit">
                                                    <group string="مؤشرات الهيكل المال">
                                                        <group>
                                                            <field name="quant_1" readonly="1"/>
                                                            <field name="res_quant_1" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_2" readonly="1"/>
                                                            <field name="res_quant_2" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_3" readonly="1"/>
                                                            <field name="res_quant_3" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_4" readonly="1"/>
                                                            <field name="res_quant_4" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="res_quant_17" readonly="1"
                                                                   string="Pondération RS5"/>
                                                        </group>
                                                        <field name="vis1" widget="image" invisible="vis1 == False"/>
                                                    </group>
                                                    <group string="مؤشرات السيولة">
                                                        <group>
                                                            <field name="quant_5" readonly="1"/>
                                                            <field name="res_quant_5" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_6" readonly="1"/>
                                                            <field name="res_quant_6" readonly="1"/>
                                                        </group>
                                                        <field name="vis2" widget="image" invisible="vis2 == False"/>
                                                    </group>
                                                    <group string="مؤشرات النشاط">
                                                        <group>
                                                            <field name="quant_7" readonly="1"/>
                                                            <field name="res_quant_7" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_8" readonly="1"/>
                                                            <field name="res_quant_8" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_9" readonly="1"/>
                                                            <field name="res_quant_9" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_10" readonly="1"/>
                                                            <field name="res_quant_10" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_11" readonly="1"/>
                                                            <field name="res_quant_11" readonly="1"/>
                                                        </group>
                                                        <field name="vis3" widget="image" invisible="vis3 == False"/>
                                                    </group>
                                                    <group string="مؤشرات المردودية">
                                                        <group>
                                                            <field name="quant_12" readonly="1"/>
                                                            <field name="res_quant_12" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_13" readonly="1"/>
                                                            <field name="res_quant_13" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_14" readonly="1"/>
                                                            <field name="res_quant_14" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_15" readonly="1"/>
                                                            <field name="res_quant_15" readonly="1"/>
                                                        </group>
                                                        <group>
                                                            <field name="quant_16" readonly="1"/>
                                                            <field name="res_quant_16" readonly="1"/>
                                                        </group>
                                                        <field name="vis4" widget="image" invisible="vis4 == False"/>
                                                    </group>
                                                    <group>
                                                        <field name="critere_ids"
                                                               options="{'no_create': True, 'no_open': True}">
                                                            <tree editable="bottom" create="0" delete="0">
                                                                <field name="name" readonly="1"/>
                                                                <field name="critere"/>
                                                                <field name="resultat" readonly="1"/>
                                                                <field name="computed_total" column_invisible="True"/>
                                                            </tree>
                                                        </field>
                                                    </group>
                                                    <field name="vis5" widget="image" invisible="vis5 == False"/>
                                                </page>
                                                <page string="تنقيط" groups="dept_wk.dept_wk_group_responsable_credit">
                                                    <group col="2">
                                                        <group col="2">
                                                            <field name="ca_banque"/>
                                                            <field name="resultat_scor" readonly="1"/>
                                                        </group>
                                                        <group col="2">
                                                            <field name="chiffre_affaire" readonly="1"/>
                                                            <field name="niveau_risque" readonly="1"/>
                                                            <field name="classif_risque"/>
                                                            <field name="taille"/>
                                                        </group>
                                                    </group>
                                                    <button name="calcul_limit" class="col-3 btn-primary"
                                                            string="Calculer la limite"
                                                            type="object"/>
                                                    <group>
                                                        <field name="resultat_scor" readonly="1"/>
                                                        <field name="limit_25" readonly="1"/>
                                                        <field name="max_limit" readonly="1"/>
                                                        <field name="case_25" readonly="1"/>
                                                    </group>
                                                </page>
                                            </notebook>
                                        </sheet>
                                    </form>
                                </field>
                                <!--<group col="3">
                                    <group>
                                        <button name="create_tcr_group" type="object" string="اضف TCR"
                                                class="button_secondary" invisible="tcr_group != False"/>
                                        <field name="tcr_group" invisible="tcr_group == False" readonly="1"/>
                                    </group>
                                    <group>
                                        <button name="create_actif_group" type="object"
                                                string="اضف Actif"
                                                class="button_secondary" invisible="actif_group != False"/>
                                        <field name="actif_group" invisible="actif_group == False" readonly="1"/>
                                    </group>
                                    <group>
                                        <button name="create_passif_group" type="object"
                                                string="اضف Passif"
                                                class="button_secondary"
                                                invisible="passif_group != False"/>
                                        <field name="passif_group" invisible="passif_group == False" readonly="1"/>
                                    </group>
                                    <button name="import_data_group" type="object"
                                            string="حمل البيانات"
                                            class="button_secondary"/>
                                </group>
                                <field name="companies_fisc" readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom" create="0" delete="0">
                                        <field name="declaration" readonly="1"
                                               decoration-bf="sequence == 0"/>
                                        <field name="year_3" readonly="sequence == 0" decoration-bf="sequence == 0"/>
                                        <field name="year_4" readonly="sequence == 0" decoration-bf="sequence == 0"/>
                                        <field name="sequence" column_invisible="True"/>
                                    </tree>
                                </field>-->
                                <group>
                                    <field name="comment_fisc" readonly="not can_edit or state_finance != 'finance_2'"/>
                                </group>
                                <button name="create_viz3" type="object" string="انشاء بيان"
                                        class="button_secondary"/>
                                <field name="visualisation2" type="base64" widget="image"
                                       invisible="visualisation2 == False"/>

                            </page>
                            <page string="التسهيلات القائمة مع المصرف">
                                <field name="facitlite_existante" width="100%"
                                       readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="company" width="10%"/>
                                        <field name="facilite" options="{'no_create': True}" column_invisible="True"/>
                                        <field name="type_demande_ids" width="10%" domain="[('for_branch', '=', False)]"
                                               options="{'no_create': True}" widget="many2many_tags"/>
                                        <field name="brut_da" sum="Total facilities" width="20%"/>
                                        <field name="brut_dollar" sum="Total facilities" optional="hide"/>
                                        <field name="net_da" sum="Total facilities" width="20%"/>
                                        <field name="net_dollar" sum="Total facilities" optional="hide"/>
                                        <field name="garanties" widget="many2many_tags" options="{'no_create': True}"
                                               width="20%"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="الحركة والأعمال الجانبية للمجموعة مع مصرف السلام الجزائر (KDA)">
                                <field name="mouvement_group" readonly="not can_edit or state_finance != 'finance_2'">
                                    <tree editable="bottom">
                                        <field name="company" readonly="'السنة' == company"/>
                                        <field name="n2_dz"/>
                                        <field name="n2_dollar" optional="hide"/>
                                        <field name="n1_dz"/>
                                        <field name="n1_dollar" optional="hide"/>
                                        <field name="n_dz"/>
                                        <field name="n_dollar" optional="hide"/>
                                        <field name="remarques" readonly="'السنة' == company"/>
                                        <field name="sequence" column_invisible="True"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        <group col="3" invisible="state_finance == 'finance_1' or sequence != 2">
                            <group>
                                <button name="action_create_tcr" type="object" string="اضف TCR للعام N و N-1"
                                        class="button_secondary" invisible="tcr_id != False"/>
                                <field name="tcr_id" invisible="tcr_id == False" readonly="1"/>
                            </group>
                            <group>
                                <button name="action_create_actif" type="object"
                                        string="اضف Actif للعام N و N-1"
                                        class="button_secondary" invisible="actif_id != False"/>
                                <field name="actif_id" invisible="actif_id == False" readonly="1"/>
                            </group>
                            <group>
                                <button name="action_create_passif" type="object"
                                        string="اضف Passif للعام N و N-1"
                                        class="button_secondary"
                                        invisible="passif_id != False"/>
                                <field name="passif_id" invisible="passif_id == False" readonly="1"/>
                            </group>
                        </group>
                        <group col="3" invisible="state_finance == 'finance_1' or sequence != 2">
                            <group>
                                <button name="action_create_tcr1" type="object" string="اضف TCR للعام 2-N و N-3"
                                        class="button_secondary" invisible="tcr1_id != False"/>
                                <field name="tcr1_id" invisible="tcr1_id == False" readonly="1"/>
                            </group>
                            <group>
                                <button name="action_create_actif1" type="object"
                                        string="اضف Actif للعام 2-N و N-3"
                                        class="button_secondary"
                                        invisible="actif1_id != False"/>
                                <field name="actif1_id" invisible="actif1_id == False" readonly="1"/>
                            </group>
                            <group>
                                <button name="action_create_passif1" type="object"
                                        string="اضف Passif للعام 2-N و N-3"
                                        class="button_secondary"
                                        invisible="passif1_id != False"/>
                                <field name="passif1_id" invisible="passif1_id == False" readonly="1"/>
                            </group>
                        </group>
                        <button name="import_data" type="object" string="حمل البيانات"
                                class="button_secondary" invisible="state_finance == 'finance_1' or sequence != 2"/>
                        <button name="verrouiller_dossier" type="object" string="قبول الملف"
                                groups="dept_wk.dept_wk_group_analyste"
                                class="button_secondary"/>
                        <group>
                            <field name="dossier_verouiller" invisible="1"/>
                        </group>
                        <notebook invisible="state_finance == 'finance_1' or sequence != 2">
                            <page string="البيانات المالية للشركة (KDA)">
                                <group string="مؤشرات البنية المالية">
                                    <field name="bilan1_id">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="declaration" readonly="1"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year_1" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_1 == True"/>
                                            <field name="year_2" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_2 == True"/>
                                            <field name="year_3" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_3 == True"/>
                                            <field name="year_4" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_4 == True"/>
                                            <field name="variante" readonly="sequence == 0" widget="percentage"
                                                   decoration-bf="sequence == 0" invisible="sequence == 0"/>
                                            <field name="sequence" column_invisible="True"/>
                                            <field name="compute_field" column_invisible="True"/>
                                            <field name="is_null_1" column_invisible="True"/>
                                            <field name="is_null_2" column_invisible="True"/>
                                            <field name="is_null_3" column_invisible="True"/>
                                            <field name="is_null_4" column_invisible="True"/>
                                        </tree>
                                    </field>
                                    <group>
                                        <field name="comment_cat1"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                </group>
                                <group string="مؤشرات المديونية">
                                    <field name="bilan2_id">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="declaration" readonly="1"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year_1" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_1 == True"/>
                                            <field name="year_2" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_2 == True"/>
                                            <field name="year_3" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_3 == True"/>
                                            <field name="year_4" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_4 == True"/>
                                            <field name="variante" readonly="sequence == 0" widget="percentage"
                                                   decoration-bf="sequence == 0" invisible="sequence == 0"/>
                                            <field name="sequence" column_invisible="True"/>
                                            <field name="compute_field" column_invisible="True"/>
                                            <field name="is_null_1" column_invisible="True"/>
                                            <field name="is_null_2" column_invisible="True"/>
                                            <field name="is_null_3" column_invisible="True"/>
                                            <field name="is_null_4" column_invisible="True"/>
                                        </tree>
                                    </field>
                                    <group>
                                        <field name="comment_cat2"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                </group>
                                <group string="مؤشرات المردودية">
                                    <field name="bilan3_id">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="declaration" readonly="1"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year_1" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_1 == True"/>
                                            <field name="year_2" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_2 == True"/>
                                            <field name="year_3" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_3 == True"/>
                                            <field name="year_4" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_4 == True"/>
                                            <field name="variante" readonly="sequence == 0" widget="percentage"
                                                   decoration-bf="sequence == 0" invisible="sequence == 0"/>
                                            <field name="sequence" column_invisible="True"/>
                                            <field name="compute_field" column_invisible="True"/>
                                            <field name="is_null_1" column_invisible="True"/>
                                            <field name="is_null_2" column_invisible="True"/>
                                            <field name="is_null_3" column_invisible="True"/>
                                            <field name="is_null_4" column_invisible="True"/>
                                        </tree>
                                    </field>
                                    <group>
                                        <field name="comment_cat3"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                </group>
                                <group string="مؤشرات السيولة">
                                    <field name="bilan4_id">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="declaration" readonly="1"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year_1" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_1 == True"/>
                                            <field name="year_2" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_2 == True"/>
                                            <field name="year_3" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_3 == True"/>
                                            <field name="year_4" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_4 == True"/>
                                            <field name="variante" readonly="sequence == 0" widget="percentage"
                                                   decoration-bf="sequence == 0" invisible="sequence == 0"/>
                                            <field name="sequence" column_invisible="True"/>
                                            <field name="compute_field" column_invisible="True"/>
                                            <field name="is_null_1" column_invisible="True"/>
                                            <field name="is_null_2" column_invisible="True"/>
                                            <field name="is_null_3" column_invisible="True"/>
                                            <field name="is_null_4" column_invisible="True"/>
                                        </tree>
                                    </field>
                                    <group>
                                        <field name="comment_cat4"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                </group>
                                <group string="مؤشرات النشاط">
                                    <field name="bilan5_id">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="declaration" readonly="1"
                                                   decoration-bf="sequence == 0"/>
                                            <field name="year_1" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_1 == True"/>
                                            <field name="year_2" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_2 == True"/>
                                            <field name="year_3" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_3 == True"/>
                                            <field name="year_4" readonly="sequence != 0"
                                                   decoration-bf="sequence == 0" decoration-danger="is_null_4 == True"/>
                                            <field name="variante" readonly="sequence == 0" widget="percentage"
                                                   decoration-bf="sequence == 0" invisible="sequence == 0"/>
                                            <field name="sequence" column_invisible="True"/>
                                            <field name="is_null_1" column_invisible="True"/>
                                            <field name="is_null_2" column_invisible="True"/>
                                            <field name="is_null_3" column_invisible="True"/>
                                            <field name="is_null_4" column_invisible="True"/>
                                            <field name="compute_field" column_invisible="True"/>
                                        </tree>
                                    </field>
                                    <group>
                                        <field name="comment_cat5"
                                               readonly="not can_edit or state_finance != 'finance_2'"/>
                                    </group>
                                </group>
                            </page>
                            <page string="ملخص للبيانات">
                                <div col="2" class="swot_table">
                                    <field name="var_ids" readonly="1" class="swot_element">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="var"/>
                                            <field name="montant"/>
                                        </tree>
                                    </field>
                                    <field name="recap_ids" readonly="not can_edit or state_finance != 'finance_2'"
                                           class="swot_element">
                                        <tree editable="bottom" create="0" delete="0">
                                            <field name="declaration" readonly="1"/>
                                            <field name="montant"/>
                                        </tree>
                                    </field>
                                </div>
                            </page>
                            <page string="الوضعية المحاسبية">
                                <group>
                                    <field name="date_situation_comptable"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                    <field name="file_tcr" filename="file_tcr_name"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                    <field name="file_tcr_name" invisible="1"/>
                                </group>

                                <button name="action_situation" type="object" string="اضافة البيانات"
                                        class="button_secondary"/>
                                <notebook>
                                    <page string="TCR">
                                        <field name="tcr_situation">
                                            <tree create="0" editable="bottom">
                                                <field name="name_ar"/>
                                                <field name="valeur"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Actif">
                                        <field name="actif_situation">
                                            <tree create="0" editable="bottom">
                                                <field name="name_ar"/>
                                                <field name="valeur"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Passif">
                                        <field name="passif_situation">
                                            <tree create="0" editable="bottom">
                                                <field name="name_ar"/>
                                                <field name="valeur"/>
                                            </tree>
                                        </field>
                                    </page>
                                </notebook>
                                <field name="visualisation_situation" invisible="visualisation_situation == False"
                                       widget="image"/>
                                <group>
                                    <field name="commentaire_situation"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                </group>
                            </page>
                            <page string="الوضعية التقديرية">
                                <group>
                                    <field name="file_tcr_estim" filename="file_tcr_name"
                                           readonly="not can_edit or state_finance != 'finance_2'"/>
                                    <field name="file_tcr_name_estim" invisible="1"/>
                                </group>

                                <button name="action_situation_estimate" type="object" string="اضافة البيانات"
                                        class="button_secondary"/>
                                <notebook>
                                    <page string="TCR">
                                        <field name="tcr_situation_estim">
                                            <tree create="0" editable="bottom">
                                                <field name="name_ar"/>
                                                <field name="valeur"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Actif">
                                        <field name="actif_situation_estim">
                                            <tree create="0" editable="bottom">
                                                <field name="name_ar"/>
                                                <field name="valeur"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Passif">
                                        <field name="passif_situation_estim">
                                            <tree create="0" editable="bottom">
                                                <field name="name_ar"/>
                                                <field name="valeur"/>
                                            </tree>
                                        </field>
                                    </page>
                                </notebook>
                            </page>
                        </notebook>
                        <button name="create_viz2" type="object" string="إنشاء البيان"
                                class="button_secondary" invisible="state_finance == 'finance_1' or sequence != 2"/>
                        <field name="visualisation1" type="base64" widget="image"
                               invisible="visualisation1 == False or state_finance == 'finance_1' or sequence != 2"/>
                        <h6 invisible="state_finance == 'finance_1' or sequence != 2">SWOT</h6>
                        <br/>
                        <div class="swot_table" invisible="state_finance == 'finance_1' or sequence != 2">
                            <field name="weakness_ids" style="background-color: #F4A460;" class="swot_element"
                                   readonly="not can_edit or state_finance != 'finance_2'">
                                <tree editable="bottom">
                                    <field name="name"/>
                                </tree>
                            </field>
                            <field name="strength_ids" style="background-color: #90EE90;" class="swot_element"
                                   readonly="not can_edit or state_finance != 'finance_2'">
                                <tree editable="bottom">
                                    <field name="name"/>
                                </tree>
                            </field>
                        </div>
                        <div class="swot_table" invisible="state_finance == 'finance_1' or sequence != 2">
                            <field name="opportunitie_ids" style="background-color: #87CEFA;" class="swot_element"
                                   readonly="not can_edit or state_finance != 'finance_2'">
                                <tree editable="bottom">
                                    <field name="name"/>
                                </tree>
                            </field>
                            <field name="threat_ids" style="background-color: #CD5C5C;" class="swot_element"
                                   readonly="not can_edit or state_finance != 'finance_2'">
                                <tree editable="bottom">
                                    <field name="name"/>
                                </tree>
                            </field>
                        </div>

                        <h3 invisible="state_finance == 'finance_1' or sequence != 2">المشروع الاستثماري</h3>
                        <group invisible="state_finance == 'finance_1' or sequence != 2">
                            <field name="description_prjt_invest"
                                   readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="actif_invest" readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="pays_prod" readonly="not can_edit or state_finance != 'finance_2'"
                                   widget="many2many_tags"/>
                            <field name="valeur_total" readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="auto_financement" readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="financement_demande" readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="duree_financement" readonly="not can_edit or state_finance != 'finance_2'"/>
                        </group>
                        <group>
                            <field name="invest_id" readonly="1"
                                   invisible="state_finance == 'finance_1' or sequence != 2"/>
                        </group>
                        <button name="action_create_invest" type="object" string="دراسة المشروع الاستثماري"
                                class="button_secondary"
                                invisible="invest_id != False or sequence != 2 or state_finance == 'finance_1'"/>
                        <group>
                            <field name="avis_invest" readonly="not can_edit or state_finance != 'finance_2'"
                                   invisible="state_finance == 'finance_1' or sequence != 2"/>
                        </group>
                        <h3 invisible="state_finance == 'finance_1'">توصية المحلل المالي</h3>
                        <group invisible="state_finance == 'finance_1'">
                            <field name="recommandation_analyste_fin"
                                   readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="facilite_propose" readonly="not can_edit or state_finance != 'finance_2'">
                                <tree editable="bottom">
                                    <field name="type_demande_ids" domain="[('for_branch', '=', False)]"
                                           options="{'no_create': True}" widget="many2many_tags"/>
                                    <field name="montant_dz" sum="Total"/>
                                    <field name="montant_dollar" sum="Total"/>
                                    <field name="preg" />
                                    <field name="duree"/>
                                    <field name="compute_exist" column_invisible="True"/>
                                    <field name="condition"/>
                                </tree>
                            </field>
                            <field name="garantie_ids" widget="many2many_tags"
                                   readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="exception_ids" widget="many2many_tags"
                                   readonly="not can_edit or state_finance != 'finance_2'"
                                   options="{'no_create': True}"/>
                            <field name="comite" options="{'no_create': True, 'no_open': True}"
                                   readonly="not can_edit or state_finance != 'finance_2'"/>
                            <field name="recommandation_dir_fin"
                                   readonly="not can_edit or state_finance != 'finance_3'"/>
                        </group>
                    </div>
                    <div invisible="sequence not in [3,5,6,9]">
                        <button type="object" name="create_viz" class="button_secondary" string="انشاء بيان"
                                invisible="sequence != 3"/>
                        <group>
                            <field name="visualisation" type="base64" widget="image" readonly="1"
                                   invisible="visualisation == False or sequence != 3"/>
                        </group>
                        <group>
                            <field name="assigned_to_commercial" invisible="sequence != 3"
                                   options="{'no_create': True, 'no_open': True}"
                                   readonly="not can_edit or state_commercial != 'commercial_1'"/>
                            <field name="analyse_secteur_act"
                                   readonly="not can_edit or state_commercial != 'commercial_2'"
                                   invisible="sequence not in [3,5,9]"/>
                            <field name="analyse_concurrence"
                                   readonly="not can_edit or state_commercial != 'commercial_2'"
                                   invisible="sequence not in [3,5,9]"/>
                            <field name="ampleur_benefice" readonly="not can_edit or state_commercial != 'commercial_2'"
                                   invisible="sequence not in [3,5,9]"/>
                            <field name="analyse_relation" readonly="not can_edit or state_commercial != 'commercial_2'"
                                   invisible="sequence not in [3,5,9]"/>
                            <field name="recommendation_commercial"
                                   readonly="not can_edit or state_commercial != 'commercial_2'"/>
                        </group>
                        <group>
                            <field name="recommendation_dir_commercial"
                                   readonly="not can_edit or state_commercial != 'commercial_3'"/>
                        </group>
                    </div>
                    <div invisible="sequence not in [4,5,6,9]">
                        <group>
                            <field name="assigned_to_risque" readonly="not can_edit or state_risque != 'risque_1'"
                                   options="{'no_create': True, 'no_open': True}"
                                   invisible="sequence not in [4]"/>
                            <field name="validator_risque"
                                   readonly="not can_edit or state_risque not in ['risque_4', 'risque_2']"
                                   options="{'no_create': True, 'no_open': True}"
                                   invisible="sequence not in [4]"/>
                        </group>

                        <button name="action_open_risk" type="object" string="انقر هنا لدراسة المخاطر"
                                class="button_secondary" invisible="sequence not in [4]"/>

                        <group>
                            <field name="resultat_scoring" invisible="sequence not in [4,5,9]"/>
                            <field name="recommandation_dir_risque"
                                   readonly="not can_edit or state_risque != 'risque_4'"/>
                        </group>
                    </div>
                    <div invisible="sequence not in [5,6,9]">
                        <group>
                            <field name="recommandation_tresorerie" readonly="not can_edit or state_vice != 'vice_1'"
                                   invisible="1"/>
                            <field name="recommandation_vice_dir_fin"
                                   readonly="not can_edit or state_vice != 'vice_1'"/>
                        </group>
                    </div>
                    <div invisible="sequence not in [9,6]">
                        <group>
                            <field name="recommandation_dg" readonly="not can_edit or state_dg != 'dg_1'"/>
                        </group>
                    </div>
                    <div invisible="sequence != 6">
                        <group>
                            <field name="recommandation_fin_comite"
                                   readonly="not can_edit or state_comite != 'comite_1'"/>
                        </group>
                    </div>
                    <button type="object" name="validate_information" string="تأكيد المعلومات"
                            invisible="state_branch in ['branch_rejected', 'branch_5'] or state_finance in ['finance_4', 'finance_rejected'] or state_risque in ['risque_2'] or state_commercial in ['commercial_4'] or state_vice in ['vice_2'] or state_dg in ['dg_2']"
                            class="button_confirm"/>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>
</odoo>